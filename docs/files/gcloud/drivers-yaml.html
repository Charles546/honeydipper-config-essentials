<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>drivers.yaml</title><link rel="stylesheet" type="text/css" href="../../styles/main.css" /><script type="text/javascript" src="../../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.0.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Gcloud.Drivers.gcloud-gke"></a><a name="Topic13"></a><div class="CTopic TSection LHoneydipperConfig first">
 <div class="CTitle"><span class="Qualifier">Gcloud.&#8203;Drivers.</span>&#8203;gcloud-gke</div>
 <div class="CBody"><p>Accessing the gcloud gke clusters</p><div class="CHeading">Prereq</div><ul><li><p>include the gcloud bundle from this repo</p></li></ul><div class="CHeading">Integration</div><p>Config the driver in the `drivers` section with following parameters.</p><ul><li><p>loglevel: the verbosity of logs generated by this driver, DEBUG, INFO, WARNING, ERROR</p></li></ul><div class="CHeading">Example</div><pre>---<br />drivers:<br />  web:<br />    loglevel: DEBUG</pre></div>
</div>

<a name="Gcloud.Drivers.gcloud-gke.RPCs"></a><a name="Topic14"></a><div class="CTopic TGroup LHoneydipperConfig">
 <div class="CTitle">RPCs</div>
</div>

<a name="Gcloud.Drivers.gcloud-gke.getKubeConfig"></a><a name="Topic15"></a><div class="CTopic TRPC LHoneydipperConfig">
 <div class="CTitle">getKubeConfig</div>
 <div class="CBody"><p>This RPC is used internally by kubernetes driver to fetch cluster endpoint and auth info.</p><div class="CHeading">Parameters</div><ul><li><p>project -- which GCP project the cluster is in</p></li><li><p>service_account -- the service account in json file format</p></li><li><p>location -- either region or zone</p></li><li><p>reginal -- true if the cluster is reginal, otherwise zonal, defaults to false</p></li><li><p>cluster -- name of the cluster</p></li></ul><div class="CHeading">Use</div><p>When calling kubenetes functions, put the parameters mentioned here in the `parameters.source`.&nbsp; These can usually be put into the system data, so they can be reused in function calls and workflows.</p></div>
</div>

<a name="Gcloud.Drivers.gcloud-kms"></a><a name="Topic16"></a><div class="CTopic TSection LHoneydipperConfig">
 <div class="CTitle"><span class="Qualifier">Gcloud.&#8203;Drivers.</span>&#8203;gcloud-kms</div>
 <div class="CBody"><p>Decrypting config data using GCP KMS</p><div class="CHeading">Prereq</div><ul><li><p>include the gcloud bundle from this repo</p></li><li><p>Honeydipper must be running inside GCP with a service account with roles/cloudkms.cryptoKeyDecrypter</p></li></ul><div class="CHeading">Integration</div><p>Config the driver in the `drivers` section with following parameters.</p><ul><li><p>loglevel: the verbosity of logs generated by this driver, DEBUG, INFO, WARNING, ERROR</p></li><li><p>keyname: the keyname in KMS, projects/&lt;project name&gt;/locations/&lt;location&gt;/keyRings/&lt;key ring name&gt;/cryptoKeys/&lt;key name&gt;</p></li></ul><div class="CHeading">Example</div><pre>---<br />drivers:<br />  gloud-kms:<br />    loglevel: DEBUG<br />    keyname: projects/example/locations/us-west1-b/keyRings/example-ring/cryptoKeys/example-key</pre><div class="CHeading">Usage</div><p>Honeydipper supports eyaml format of encrypted content, just specify the the ciphertext and driver name in `ENC[...]`.</p><pre>---<br />systems:<br />  example-system:<br />    secret: ENC[gcloud-kms,&lt;... base64 encoded ciphertext ...&gt;]<br />    ...</pre></div>
</div>

<a name="Gcloud.Drivers.gcloud-kms.RPCs"></a><a name="Topic17"></a><div class="CTopic TGroup LHoneydipperConfig">
 <div class="CTitle">RPCs</div>
</div>

<a name="Gcloud.Drivers.gcloud-kms.decrypt"></a><a name="Topic18"></a><div class="CTopic TRPC LHoneydipperConfig">
 <div class="CTitle">decrypt</div>
 <div class="CBody"><p>This RPC is used internally by Honeydipper and other drivers to decrypt content.</p><div class="CHeading">Parameters</div><ul><li><p>the whole dipper.Message raw payload is the ciphertext in `byte[]`</p></li></ul></div>
</div>

<a name="Gcloud.Drivers.gcloud-dataflow"></a><a name="Topic19"></a><div class="CTopic TSection LHoneydipperConfig">
 <div class="CTitle"><span class="Qualifier">Gcloud.&#8203;Drivers.</span>&#8203;gcloud-dataflow</div>
 <div class="CBody"><p>Creating and managing dataflow job</p><div class="CHeading">Prereq</div><ul><li><p>include the gcloud bundle from this repo</p></li></ul><div class="CHeading">Integration</div><p>Config the driver in the `drivers` section with following parameters.</p><ul><li><p>loglevel: the verbosity of logs generated by this driver, DEBUG, INFO, WARNING, ERROR</p></li></ul><div class="CHeading">Example</div><pre>---<br />drivers:<br />  gloud-dataflow:<br />    loglevel: DEBUG</pre></div>
</div>

<a name="Gcloud.Drivers.gcloud-dataflow.RawActions"></a><a name="Topic20"></a><div class="CTopic TGroup LHoneydipperConfig">
 <div class="CTitle">RawActions</div>
</div>

<a name="Gcloud.Drivers.gcloud-dataflow.createJob"></a><a name="Topic21"></a><div class="CTopic TRawAction LHoneydipperConfig">
 <div class="CTitle">createJob</div>
 <div class="CBody"><p>create dataflow job with a template.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">service_account</td><td class="CDLDefinition"><p>the service account used for accessing gcloud to create the job</p></td></tr><tr><td class="CDLEntry">project</td><td class="CDLDefinition"><p>the GCP project</p></td></tr><tr><td class="CDLEntry">location</td><td class="CDLDefinition"><p>required for location based dataflow job</p></td></tr><tr><td class="CDLEntry">regional</td><td class="CDLDefinition"><p>set to true for regional dataflow job, ignoring location, defaults to false</p></td></tr><tr><td class="CDLEntry">job</td><td class="CDLDefinition"><p>the specification for the job, see <a href="https://godoc.org/google.golang.org/api/dataflow/v1b3#CreateJobFromTemplateRequest" target="_top">https://&#8203;godoc&#8203;.org&#8203;/google&#8203;.golang&#8203;.org&#8203;/api&#8203;/dataflow&#8203;/v1b3&#8203;#CreateJobFromTemplateRequest</a> for detail</p></td></tr></table><div class="CHeading">Return</div><table class="CDefinitionList"><tr><td class="CDLEntry">.data.job</td><td class="CDLDefinition"><p>the job object, see <a href="https://godoc.org/google.golang.org/api/dataflow/v1b3#Job" target="_top">https://&#8203;godoc&#8203;.org&#8203;/google&#8203;.golang&#8203;.org&#8203;/api&#8203;/dataflow&#8203;/v1b3&#8203;#Job</a> for detail</p></td></tr></table><div class="CHeading">Examples</div><p>Create a new job with teamplate.</p><pre>rules:<br />  - when:<br />      ...<br />  - do:<br />      type: function<br />      content:<br />        driver: gcloud-dataflow<br />        rawAction: createJob<br />        parameters:<br />          service_account: xxxxxxx<br />          project: example-project<br />          location: us-west1-c<br />          job:<br />            ...</pre></div>
</div>

<a name="Gcloud.Drivers.gcloud-dataflow.waitForJob"></a><a name="Topic22"></a><div class="CTopic TRawAction LHoneydipperConfig">
 <div class="CTitle">waitForJob</div>
 <div class="CBody"><p>wait for the dataflow job to reach terminal states and return a job status.</p><pre>terminatedStates := map[string]bool{<br />  &quot;JOB_STATE_DONE&quot;:      true,<br />  &quot;JOB_STATE_FAILED&quot;:    true,<br />  &quot;JOB_STATE_CANCELLED&quot;: true,<br />  &quot;JOB_STATE_UPDATED&quot;:   true,<br />  &quot;JOB_STATE_DRAINED&quot;:   true,<br />}</pre><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">service_account</td><td class="CDLDefinition"><p>the service account used for accessing gcloud to create the job</p></td></tr><tr><td class="CDLEntry">project</td><td class="CDLDefinition"><p>the GCP project</p></td></tr><tr><td class="CDLEntry">location</td><td class="CDLDefinition"><p>required for location based dataflow job</p></td></tr><tr><td class="CDLEntry">regional</td><td class="CDLDefinition"><p>set to true for regional dataflow job, ignoring location, defaults to false</p></td></tr><tr><td class="CDLEntry">jobID</td><td class="CDLDefinition"><p>the ID of the job</p></td></tr><tr><td class="CDLEntry">timeout</td><td class="CDLDefinition"><p>time period before a timeout error is raised</p></td></tr><tr><td class="CDLEntry">interval</td><td class="CDLDefinition"><p>the interval between API calls polling the job status</p></td></tr></table><div class="CHeading">Return</div><p>.data.job -- the job object, see <a href="https://godoc.org/google.golang.org/api/dataflow/v1b3#Job" target="_top">https://&#8203;godoc&#8203;.org&#8203;/google&#8203;.golang&#8203;.org&#8203;/api&#8203;/dataflow&#8203;/v1b3&#8203;#Job</a> for detail</p><div class="CHeading">Examples</div><p>Wait for a job to complete.</p><pre>rules:<br />  - when:<br />      ...<br />  - do:<br />      type: function<br />      content:<br />        driver: gcloud-dataflow<br />        rawAction: waitForJob<br />        parameters:<br />          service_account: xxxxxxx<br />          project: example-project<br />          location: us-west1-c<br />          jobID: ...<br />          timeout: 1800<br />          interval: 10</pre></div>
</div>

<a name="Gcloud.Drivers.gcloud-dataflow.getJob"></a><a name="Topic32"></a><div class="CTopic TRawAction LHoneydipperConfig">
 <div class="CTitle">getJob</div>
 <div class="CBody"><p>query the job info and status with a jobID</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">service_account</td><td class="CDLDefinition"><p>the service account used for accessing gcloud to create the job</p></td></tr><tr><td class="CDLEntry">project</td><td class="CDLDefinition"><p>the GCP project</p></td></tr><tr><td class="CDLEntry">location</td><td class="CDLDefinition"><p>required for location based dataflow job</p></td></tr><tr><td class="CDLEntry">regional</td><td class="CDLDefinition"><p>set to true for regional dataflow job, ignoring location, defaults to false</p></td></tr><tr><td class="CDLEntry">jobID</td><td class="CDLDefinition"><p>the ID of the job</p></td></tr></table><div class="CHeading">Return</div><p>.data.job -- the job object, see <a href="https://godoc.org/google.golang.org/api/dataflow/v1b3#Job" target="_top">https://&#8203;godoc&#8203;.org&#8203;/google&#8203;.golang&#8203;.org&#8203;/api&#8203;/dataflow&#8203;/v1b3&#8203;#Job</a> for detail</p><div class="CHeading">Examples</div><pre>workflows:<br />  check-dataflow-job-status:<br />    type: pipe<br />    content:<br />      - type: <span class="SHKeyword">function</span><br />        content:<br />          driver: gcloud-dataflow<br />          rawAction: getJob<br />          parameters:<br />            service_account: xxxxxxx<br />            project: example-project<br />            location: us-west1-c<br />            jobID: {{ .wfdata.jobID }}<br />      - content: notify<br />        data:<br />          message:<br />            attachments:<br />              - color: <span class="SHString">'{{ ternary &quot;good&quot; &quot;danger&quot; (eq .data.job.currentState &quot;JOB_STATE_DONE&quot;) }}'</span><br />                text: Job state is {{ .data.job.currentState }}</pre></div>
</div>

<a name="Gcloud.Drivers.gcloud-dataflow.listJob"></a><a name="Topic41"></a><div class="CTopic TRawAction LHoneydipperConfig last">
 <div class="CTitle">listJob</div>
 <div class="CBody"><p>query a list of jobs with given filter and fields list.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">service_account</td><td class="CDLDefinition"><p>the service account used for accessing gcloud to create the job</p></td></tr><tr><td class="CDLEntry">project</td><td class="CDLDefinition"><p>the GCP project</p></td></tr><tr><td class="CDLEntry">location</td><td class="CDLDefinition"><p>required for location based dataflow job</p></td></tr><tr><td class="CDLEntry">fields</td><td class="CDLDefinition"><p>the list of fields to query</p></td></tr><tr><td class="CDLEntry">filter</td><td class="CDLDefinition"><p>the filter, see <a href="https://godoc.org/google.golang.org/api/dataflow/v1b3#ProjectsJobsListCall.Filter" target="_top">https://&#8203;godoc&#8203;.org&#8203;/google&#8203;.golang&#8203;.org&#8203;/api&#8203;/dataflow&#8203;/v1b3&#8203;#ProjectsJobsListCall&#8203;.Filter</a></p></td></tr></table><div class="CHeading">Return</div><table class="CDefinitionList"><tr><td class="CDLEntry">.data.result</td><td class="CDLDefinition"><p>see <a href="https://godoc.org/google.golang.org/api/dataflow/v1b3#ListJobsResponse" target="_top">https://&#8203;godoc&#8203;.org&#8203;/google&#8203;.golang&#8203;.org&#8203;/api&#8203;/dataflow&#8203;/v1b3&#8203;#ListJobsResponse</a> for detail</p></td></tr></table></div>
</div>

</body></html>